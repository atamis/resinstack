kernel:
  image: linuxkit/kernel:4.19.90
  cmdline: "console=tty0 console=ttyS0 console=ttyAMA0"
init:
  - linuxkit/init:1d8e0532ca588c5ad0d9ca6038349a70bb7ac626
  - linuxkit/runc:c1f0db27e71d948f3134b31ce76276f843849b0a
  - linuxkit/containerd:751de142273e1b5d2d247d2832d654ab92e907bc
onboot:
  - name: sysctl
    image: linuxkit/sysctl:v0.7
  - name: dhcpcd
    image: linuxkit/dhcpcd:v0.7
    command: ["/sbin/dhcpcd", "--nobackground", "-d", "-f", "/dhcpcd.conf", "-1"]
  - name: format
    image: linuxkit/format:65b9e0a76d0b9fb8ac5c5f3bc8d3131109290f56
  - name: mount
    image: linuxkit/mount:v0.7
    command: ["/usr/bin/mountie", "/var/persist"]
services:
  - name: getty
    image: linuxkit/getty:v0.7
    env:
     - INSECURE=true
  - name: consul
    image: consul:1.6.1
    command: ["/bin/consul", "agent", "-config-dir", "/consul/config"]
    capabilities:
      - CAP_SETUID
      - CAP_SETGID
    binds:
      - /var/persist:/consul/data
      - /consul/config:/consul/config
    net: host
files:
  - path: consul/config/server.hcl
    source: server.hcl
    mode: "0644"
    optional: false
  - path: var/persist
    directory: true
    mode: "0755"
